#!/usr/bin/env python2
# -*- backup-inhibited: true -*-
#
# oveja electrica - oe3.0.1:bleu
# copyright (c) 2003-2017 santiago pereson <yaco@yaco.net>
# http://yaco.net/oe/
#
# this file is part of 'oe3', which is released under the gnu general public
# license, version 3. see LICENSE for full license details.
#
# TO-DO:
# * one redux > curses-redux
# * gen layout
# * curses draw reduxes
# + add data (id, name) at top left/right
# x check argv, default to var/state/currestim
# - argparse, usage
#

"""estimwatch
estim watcher for voe3t

usage: bin/estimwatch [<file>]
"""
from __future__ import print_function

import os
import sys
import time

sys.path.append(os.path.abspath(os.path.dirname(__file__) + '/../lib'))


def main(argv = sys.argv):
  estimpath = 'var/state/currestim' if len(argv) == 1 else argv[1]
  currestim = ''
  with open(estimpath) as f:
    currestim = f.read()
  print(currestim.strip() + " [estimwatch]", end='')
  sys.stdout.flush()
  while True:
    time.sleep(60)

if __name__ == "__main__":
  try:
    main(sys.argv)
  except KeyboardInterrupt:
    print
    exit(130)
